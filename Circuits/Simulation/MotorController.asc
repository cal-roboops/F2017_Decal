Version 4
SHEET 1 2712 2204
WIRE -48 -656 -48 -688
WIRE 912 -656 912 -688
WIRE 256 -608 112 -608
WIRE 432 -608 432 -688
WIRE 432 -608 336 -608
WIRE 544 -608 432 -608
WIRE 752 -608 624 -608
WIRE -288 -592 -288 -624
WIRE 1168 -592 1168 -624
WIRE -1040 -544 -1088 -544
WIRE -816 -544 -880 -544
WIRE -48 -512 -48 -576
WIRE 112 -512 112 -608
WIRE 112 -512 -48 -512
WIRE 752 -512 752 -608
WIRE 912 -512 912 -576
WIRE 912 -512 752 -512
WIRE -48 -480 -48 -512
WIRE 912 -480 912 -512
WIRE -960 -448 -960 -496
WIRE -288 -432 -288 -512
WIRE -224 -432 -288 -432
WIRE -112 -432 -144 -432
WIRE 1024 -432 976 -432
WIRE 1168 -432 1168 -512
WIRE 1168 -432 1104 -432
WIRE -288 -400 -288 -432
WIRE 1168 -400 1168 -432
WIRE 432 -384 432 -432
WIRE -1568 -352 -1568 -384
WIRE -608 -352 -640 -352
WIRE -480 -352 -544 -352
WIRE -352 -352 -400 -352
WIRE 1280 -352 1232 -352
WIRE 1424 -352 1360 -352
WIRE 1520 -352 1488 -352
WIRE -48 -336 -48 -384
WIRE 112 -336 112 -512
WIRE 320 -336 112 -336
WIRE 752 -336 752 -512
WIRE 752 -336 544 -336
WIRE 912 -336 912 -384
WIRE -976 -272 -976 -304
WIRE -816 -272 -816 -304
WIRE -288 -256 -288 -304
WIRE 1168 -256 1168 -304
WIRE -1568 -224 -1568 -272
WIRE 320 -224 160 -224
WIRE 688 -224 544 -224
WIRE -976 -144 -976 -192
WIRE -816 -144 -816 -192
WIRE -64 -32 -64 -64
WIRE 960 -32 960 -64
WIRE 160 -16 160 -224
WIRE 240 -16 160 -16
WIRE 432 -16 432 -176
WIRE 432 -16 320 -16
WIRE 528 -16 432 -16
WIRE 688 -16 688 -224
WIRE 688 -16 608 -16
WIRE 432 64 432 -16
WIRE -384 80 -384 48
WIRE 1280 80 1280 48
WIRE 688 112 688 -16
WIRE 960 112 960 48
WIRE 960 112 688 112
WIRE -64 128 -64 48
WIRE 160 128 160 -16
WIRE 160 128 -64 128
WIRE -64 192 -64 128
WIRE -64 192 -128 192
WIRE 16 192 -64 192
WIRE 960 192 960 112
WIRE 960 192 880 192
WIRE 1024 192 960 192
WIRE -1584 224 -1584 192
WIRE -384 240 -384 160
WIRE -320 240 -384 240
WIRE -192 240 -240 240
WIRE 128 240 80 240
WIRE 432 240 208 240
WIRE 688 240 432 240
WIRE 816 240 768 240
WIRE 1136 240 1088 240
WIRE 1280 240 1280 160
WIRE 1280 240 1216 240
WIRE -384 272 -384 240
WIRE 1280 272 1280 240
WIRE -64 288 -128 288
WIRE 16 288 -64 288
WIRE 960 288 880 288
WIRE 1024 288 960 288
WIRE -704 320 -736 320
WIRE -576 320 -640 320
WIRE -448 320 -496 320
WIRE 1392 320 1344 320
WIRE 1536 320 1472 320
WIRE 1632 320 1600 320
WIRE -64 352 -64 288
WIRE 960 352 960 288
WIRE -1584 368 -1584 304
WIRE -384 416 -384 368
WIRE 1280 416 1280 368
WIRE 288 480 256 480
WIRE 432 480 432 240
WIRE 432 480 368 480
WIRE 464 480 432 480
WIRE 624 480 560 480
WIRE -1776 560 -1776 512
WIRE -1184 576 -1184 512
WIRE 512 576 512 544
WIRE -1776 704 -1776 640
WIRE 512 704 512 656
WIRE -1184 720 -1184 656
FLAG -1584 368 0
FLAG -1568 -224 0
FLAG -1568 -384 V_Lion
FLAG -1584 192 FPGA_PWM
FLAG 624 480 0
FLAG -48 -688 V_Gain
FLAG -48 -336 0
FLAG 512 704 FPGA_PWM
FLAG 960 352 0
FLAG -64 352 0
FLAG 912 -688 V_Gain
FLAG 912 -336 0
FLAG 1168 -256 0
FLAG 1520 -352 B
FLAG -384 416 0
FLAG -1776 704 0
FLAG -816 -544 V_Gain
FLAG -960 -448 0
FLAG 432 -432 V_Lion
FLAG 432 64 0
FLAG -1088 -544 V_Lion
FLAG -976 -144 0
FLAG -976 -304 V_Gain
FLAG -816 -144 0
FLAG -816 -304 V_5V
FLAG 256 480 V_5V
FLAG -384 48 V_5V
FLAG 1168 -624 V_5V
FLAG -64 -64 V_Gain
FLAG 960 -64 V_Gain
FLAG 432 -688 0
FLAG -1184 720 0
FLAG -1184 512 B
FLAG -1776 512 F
FLAG 1280 416 0
FLAG 1280 48 V_5V
FLAG 1632 320 F
FLAG -288 -256 0
FLAG -288 -624 V_5V
FLAG -736 320 B
FLAG -640 -352 F
SYMBOL voltage -1584 208 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VFPGA_FSpeed
SYMATTR Value PULSE(0V 5V 0ms 1us 1us {TP} 1ms)
SYMBOL voltage -1568 -368 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4CLion
SYMATTR Value {VCell*4}
SYMBOL npn 464 544 R270
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL res 496 672 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R1
SYMATTR Value 10K
SYMBOL res 272 496 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value 10K
SYMBOL npn -112 -480 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL res -64 -672 R0
SYMATTR InstName R4
SYMATTR Value 100K
SYMBOL npn 1088 192 M0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL res 976 -48 M0
SYMATTR InstName R6
SYMATTR Value 100K
SYMBOL npn 816 192 R0
SYMATTR InstName Q4
SYMATTR Value 2N3904
SYMBOL res 672 224 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 10K
SYMBOL npn -192 192 R0
SYMATTR InstName Q5
SYMATTR Value 2N3904
SYMBOL res -592 336 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R16
SYMATTR Value 10K
SYMBOL res -80 -48 R0
SYMATTR InstName R13
SYMATTR Value 100K
SYMBOL npn 80 192 M0
SYMATTR InstName Q6
SYMATTR Value 2N3904
SYMBOL res 224 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10K
SYMBOL npn 976 -480 M0
SYMATTR InstName Q8
SYMATTR Value 2N3904
SYMBOL res 1120 -448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10K
SYMBOL res 928 -672 M0
SYMATTR InstName R8
SYMATTR Value 100K
SYMBOL npn 1232 -400 M0
SYMATTR InstName Q9
SYMATTR Value 2N3904
SYMBOL res 1184 -608 M0
SYMATTR InstName R10
SYMATTR Value 10K
SYMBOL res 1376 -336 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value 10K
SYMBOL res -336 256 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value 10K
SYMBOL npn -448 272 R0
SYMATTR InstName Q7
SYMATTR Value 2N3904
SYMBOL res -400 64 R0
SYMATTR InstName R15
SYMATTR Value 10K
SYMBOL voltage -1776 544 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VFPGA_CTRL
SYMATTR Value PWL(0s 5V 139ms 5V 140ms 0V 240ms 0V)
SYMBOL diode 1488 -368 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D10
SYMATTR Value 1N4148
SYMBOL NMOSFullBridge 432 -272 R0
SYMATTR InstName X9
SYMBOL voltage -976 -288 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vg
SYMATTR Value 22V
SYMBOL voltage -816 -288 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5V
SYMATTR Value 5V
SYMBOL res 224 0 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 1Meg
SYMBOL res 624 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 1Meg
SYMBOL res 640 -624 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1Meg
SYMBOL res 240 -592 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R20
SYMATTR Value 1Meg
SYMBOL voltage -1184 560 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VFPGA_CTRL1
SYMATTR Value PWL(0s 0V 140ms 0V 141ms 5V 240ms 5V)
SYMBOL diode -704 336 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL res 1488 336 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R5
SYMATTR Value 10K
SYMBOL res 1232 256 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R21
SYMATTR Value 10K
SYMBOL npn 1344 272 M0
SYMATTR InstName Q10
SYMATTR Value 2N3904
SYMBOL res 1296 64 M0
SYMATTR InstName R22
SYMATTR Value 10K
SYMBOL diode 1600 336 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL res -240 -448 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10K
SYMBOL npn -352 -400 R0
SYMATTR InstName Q11
SYMATTR Value 2N3904
SYMBOL res -304 -608 R0
SYMATTR InstName R23
SYMATTR Value 10K
SYMBOL res -496 -336 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R24
SYMATTR Value 10K
SYMBOL diode -608 -368 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D3
SYMATTR Value 1N4148
TEXT -1152 1104 Left 2 !.tran 0 280ms 1n uic
TEXT -1560 352 Left 2 ;PWM Pulse: PULSE(0V 5V 10ms 1ms 1ms 0.5s 1s)
TEXT -1640 -184 Left 2 !.param VCell=4
TEXT -1752 680 Left 2 ;PWL(0s 0V 39ms 0V 40ms 3.3V 80ms 3.3V)
TEXT -1256 976 Left 2 !;step param TP 0.0001 0.0005 0.0001
TEXT -1144 936 Left 2 !.PARAM TP=1ms
