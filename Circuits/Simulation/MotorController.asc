Version 4
SHEET 1 1556 1780
WIRE -96 -528 -160 -528
WIRE 32 -528 -16 -528
WIRE 272 -528 224 -528
WIRE -1168 -496 -1168 -528
WIRE -1008 -496 -1008 -528
WIRE -848 -496 -848 -528
WIRE -704 -496 -704 -528
WIRE -400 -464 -432 -464
WIRE -160 -464 -160 -528
WIRE -160 -464 -272 -464
WIRE 288 -464 224 -464
WIRE 416 -464 368 -464
WIRE 512 -464 416 -464
WIRE 544 -464 512 -464
WIRE -400 -432 -432 -432
WIRE -208 -432 -272 -432
WIRE 32 -432 -32 -432
WIRE 416 -432 416 -464
WIRE 512 -432 512 -464
WIRE -400 -400 -432 -400
WIRE -160 -400 -272 -400
WIRE -1168 -368 -1168 -416
WIRE -1008 -368 -1008 -416
WIRE -848 -368 -848 -416
WIRE -704 -368 -704 -416
WIRE -160 -320 -160 -400
WIRE -96 -320 -160 -320
WIRE 32 -320 -16 -320
WIRE 272 -320 224 -320
WIRE 416 -320 416 -368
WIRE 512 -320 512 -352
WIRE 288 -256 224 -256
WIRE 416 -256 368 -256
WIRE 512 -256 416 -256
WIRE 560 -256 512 -256
WIRE -704 -224 -704 -256
WIRE 32 -224 -32 -224
WIRE 416 -224 416 -256
WIRE 512 -224 512 -256
WIRE 1152 -192 1152 -224
WIRE 1152 -192 896 -192
WIRE 1392 -192 1152 -192
WIRE 896 -144 896 -192
WIRE 1024 -144 896 -144
WIRE 1392 -144 1392 -192
WIRE 1392 -144 1264 -144
WIRE 896 -128 896 -144
WIRE 1392 -128 1392 -144
WIRE -1456 -112 -1456 -160
WIRE -1280 -112 -1280 -160
WIRE 416 -112 416 -160
WIRE 512 -112 512 -144
WIRE 1024 -112 1024 -144
WIRE 1264 -112 1264 -144
WIRE -704 -96 -704 -144
WIRE 848 -48 816 -48
WIRE 1344 -48 1328 -48
WIRE 896 -16 896 -32
WIRE 1024 -16 1024 -48
WIRE 1024 -16 896 -16
WIRE 1264 -16 1264 -48
WIRE 1392 -16 1392 -32
WIRE 1392 -16 1264 -16
WIRE -1456 32 -1456 -32
WIRE -1280 32 -1280 -32
WIRE 896 48 896 -16
WIRE 1104 48 896 48
WIRE 1392 48 1392 -16
WIRE 1392 48 1184 48
WIRE 896 112 896 48
WIRE 1024 112 896 112
WIRE 1392 112 1392 48
WIRE 1392 112 1264 112
WIRE 896 128 896 112
WIRE 1392 128 1392 112
WIRE 1024 144 1024 112
WIRE 1264 144 1264 112
WIRE -1776 208 -1776 160
WIRE 848 208 816 208
WIRE 1344 208 1328 208
WIRE 896 240 896 224
WIRE 1024 240 1024 208
WIRE 1024 240 896 240
WIRE 1264 240 1264 208
WIRE 1392 240 1392 224
WIRE 1392 240 1264 240
WIRE 896 288 896 240
WIRE 1152 288 896 288
WIRE 1392 288 1392 240
WIRE 1392 288 1152 288
WIRE 1152 336 1152 288
WIRE -1776 352 -1776 288
WIRE -1424 752 -1456 752
WIRE -1344 752 -1360 752
WIRE -1168 752 -1264 752
WIRE -1008 768 -1008 736
WIRE -1168 816 -1168 752
WIRE -1136 816 -1168 816
WIRE -912 832 -944 832
WIRE -848 832 -912 832
WIRE -704 832 -768 832
WIRE -640 832 -704 832
WIRE -1136 848 -1168 848
WIRE -704 864 -704 832
WIRE -1008 912 -1008 896
WIRE -976 912 -976 896
WIRE -976 912 -1008 912
WIRE -1424 928 -1456 928
WIRE -1344 928 -1360 928
WIRE -1168 928 -1168 848
WIRE -1168 928 -1264 928
WIRE -1056 928 -1056 896
WIRE -1008 928 -1008 912
WIRE -704 960 -704 928
WIRE -1040 1024 -1040 896
WIRE -912 1024 -912 832
WIRE -912 1024 -1040 1024
WIRE -432 1024 -480 1024
WIRE -112 1024 -208 1024
WIRE -1280 1088 -1312 1088
WIRE -1120 1088 -1200 1088
WIRE -1088 1088 -1120 1088
WIRE -992 1088 -1008 1088
WIRE -912 1088 -992 1088
WIRE -768 1088 -832 1088
WIRE -1376 1104 -1536 1104
WIRE -432 1104 -512 1104
WIRE -144 1104 -144 1088
WIRE -144 1104 -208 1104
WIRE -1120 1120 -1120 1088
WIRE -768 1168 -768 1088
WIRE -720 1168 -768 1168
WIRE -432 1184 -480 1184
WIRE -176 1184 -208 1184
WIRE -1536 1200 -1536 1104
WIRE -1488 1200 -1536 1200
WIRE -176 1200 -176 1184
WIRE -144 1200 -144 1184
WIRE -144 1200 -176 1200
WIRE -1376 1216 -1376 1104
WIRE -1376 1216 -1424 1216
WIRE -1312 1216 -1312 1088
WIRE -1312 1216 -1376 1216
WIRE -1232 1216 -1312 1216
WIRE -992 1216 -992 1088
WIRE -960 1216 -992 1216
WIRE -480 1216 -480 1184
WIRE -144 1216 -144 1200
WIRE -1488 1232 -1632 1232
WIRE -1120 1232 -1120 1184
WIRE -1120 1232 -1168 1232
WIRE -768 1232 -768 1168
WIRE -768 1232 -896 1232
WIRE -1232 1248 -1264 1248
WIRE -960 1248 -992 1248
WIRE -1264 1280 -1264 1248
WIRE -1120 1280 -1120 1232
WIRE -1200 1296 -1200 1264
WIRE -928 1296 -928 1264
WIRE -480 1328 -480 1296
WIRE -144 1328 -144 1296
WIRE -1312 1360 -1312 1216
WIRE -1280 1360 -1312 1360
WIRE -1120 1360 -1120 1344
WIRE -1120 1360 -1200 1360
WIRE -992 1360 -992 1248
WIRE -992 1360 -1120 1360
WIRE -640 1392 -800 1392
WIRE -496 1424 -560 1424
WIRE -336 1424 -416 1424
WIRE -800 1488 -800 1392
WIRE -752 1488 -800 1488
WIRE -640 1504 -640 1392
WIRE -640 1504 -688 1504
WIRE -560 1504 -560 1424
WIRE -480 1504 -560 1504
WIRE -752 1520 -816 1520
WIRE -336 1520 -336 1424
WIRE -336 1520 -416 1520
WIRE -480 1536 -512 1536
WIRE -512 1584 -512 1536
WIRE -640 1632 -720 1632
WIRE -560 1632 -560 1504
FLAG -848 -368 0
FLAG -1008 -368 0
FLAG 1152 336 0
FLAG -1008 -528 V_12V
FLAG -848 -528 V_5V
FLAG 1152 -224 V_12V
FLAG 512 -320 0
FLAG 512 -112 0
FLAG 560 -256 Vfi
FLAG 544 -464 Vbi
FLAG 1328 208 Vfi
FLAG 816 -48 Vfi
FLAG 816 208 Vbi
FLAG 1328 -48 Vbi
FLAG -112 1024 S2_PWM
FLAG -144 1088 V_5V
FLAG -512 1104 0
FLAG -144 1328 0
FLAG -1456 32 0
FLAG -480 1328 0
FLAG -208 -432 S2_PWM
FLAG -32 -224 0
FLAG -32 -432 0
FLAG 272 -320 V_12V
FLAG 272 -528 V_12V
FLAG -1456 -160 uCSpeed
FLAG -1280 32 0
FLAG -1280 -160 uCDir
FLAG -432 -464 uCDir
FLAG -432 -400 0
FLAG -432 -432 V_5V
FLAG -1776 352 0
FLAG -1776 160 fSpeed
FLAG 416 -320 0
FLAG 416 -112 0
FLAG -1168 -368 0
FLAG -1168 -528 V_36V
FLAG -1456 752 uCSpeed
FLAG -1456 928 fSpeed
FLAG -704 -368 0
FLAG -704 -528 V_1V
FLAG -1008 736 V_5V
FLAG -704 -96 0
FLAG -704 -256 V_N5V
FLAG -1008 928 V_N5V
FLAG -1056 928 0
FLAG -704 960 0
FLAG -640 832 RatioOut
FLAG -1264 1280 0
FLAG -928 1296 0
FLAG -1200 1296 0
FLAG -928 1200 V_5V
FLAG -1200 1200 V_5V
FLAG -720 1632 uCSpeed
FLAG -480 1024 M_In
FLAG -720 1168 AbsOut
FLAG -1456 1184 V_5V
FLAG -1456 1248 V_N5V
FLAG -720 1472 V_5V
FLAG -720 1536 V_N5V
FLAG -1632 1232 RatioOut
FLAG -816 1520 RatioOut
FLAG -512 1584 0
FLAG -448 1552 V_5V
FLAG -448 1488 0
FLAG -560 1424 adder
SYMBOL nmos 848 -128 R0
SYMATTR InstName F_H
SYMATTR Value IRF7821
SYMBOL voltage -1008 -512 R0
SYMATTR InstName V12V
SYMATTR Value 12V
SYMBOL voltage -848 -512 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5V
SYMATTR Value 5V
SYMBOL res 272 -240 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 1K
SYMBOL res 496 -240 R0
SYMATTR InstName R2
SYMATTR Value 9K
SYMBOL res 272 -448 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 1K
SYMBOL res 496 -448 R0
SYMATTR InstName R4
SYMATTR Value 9K
SYMBOL nmos 1344 -128 R0
SYMATTR InstName B_H
SYMATTR Value IRF7821
SYMBOL nmos 1344 128 R0
SYMATTR InstName F_L
SYMATTR Value IRF7821
SYMBOL nmos 848 128 R0
SYMATTR InstName B_L
SYMATTR Value IRF7821
SYMBOL diode 1040 -48 R180
WINDOW 0 -48 66 Left 2
WINDOW 3 -66 -2 Left 2
SYMATTR InstName D_FH
SYMATTR Value 1N4148
SYMBOL diode 1280 -48 R180
WINDOW 0 24 64 Left 2
WINDOW 3 18 7 Left 2
SYMATTR InstName D_BH
SYMATTR Value 1N4148
SYMBOL diode 1280 208 R180
WINDOW 0 24 64 Left 2
WINDOW 3 20 4 Left 2
SYMATTR InstName D_FL
SYMATTR Value 1N4148
SYMBOL diode 1040 208 R180
WINDOW 0 -50 66 Left 2
WINDOW 3 -69 2 Left 2
SYMATTR InstName D_BL
SYMATTR Value 1N4148
SYMBOL SpecialFunctions\\LTC6992-1 -320 1104 R0
SYMATTR InstName U2
SYMBOL res -496 1200 R0
SYMATTR InstName R_set1
SYMATTR Value 500K
SYMBOL res -160 1088 R0
SYMATTR InstName R_top
SYMATTR Value 1Meg
SYMBOL res -160 1200 R0
SYMATTR InstName R_bot
SYMATTR Value 500K
SYMBOL voltage -1456 -128 R0
SYMATTR InstName uASoeed
SYMATTR Value 4V
SYMBOL Optos\\4N25 128 -464 R0
SYMATTR InstName U1
SYMBOL Optos\\4N25 128 -256 R0
SYMATTR InstName U3
SYMBOL res -112 -512 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R5
SYMATTR Value 330
SYMBOL res -112 -304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value 330
SYMBOL voltage -1280 -128 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName uDDir
SYMATTR Value PULSE(0V 5V 50ms 0.1ms 0.1ms 50ms 100ms)
SYMBOL voltage -1776 192 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName fASpeed
SYMATTR Value PWL(0s 0V 10ms 0V 11ms 3V 39ms 3V 40ms 3.5V 69ms 3.5V 70ms 4V )
SYMBOL cap 400 -432 R0
SYMATTR InstName C1
SYMATTR Value 0.01µF
SYMBOL cap 400 -224 R0
SYMATTR InstName C2
SYMATTR Value 0.01µF
SYMBOL voltage -1168 -512 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V36V
SYMATTR Value 36V
SYMBOL ind 1088 64 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 0.1m
SYMATTR SpiceLine Ipk=50 Rser=0.000123 Rpar=4.71 Cpar=0
SYMBOL ADG719 -336 -432 R0
SYMATTR InstName U4
SYMBOL voltage -704 -512 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1V
SYMATTR Value 1V
SYMBOL Opamps\\LTC2053 -1024 832 R0
SYMATTR InstName U6
SYMBOL voltage -704 -240 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VN5V
SYMATTR Value -5V
SYMBOL res -864 848 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value 1K
SYMBOL cap -720 864 R0
SYMATTR InstName C4
SYMATTR Value 0.01µF
SYMBOL res -1360 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R8
SYMATTR Value 1K
SYMBOL res -1360 944 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R9
SYMATTR Value 1K
SYMBOL Opamps\\LT1001 -1200 1168 R0
SYMATTR InstName U5
SYMBOL Opamps\\LT1001 -928 1168 R0
SYMATTR InstName U8
SYMBOL res -1184 1072 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10K
SYMBOL res -992 1072 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10K
SYMBOL res -816 1072 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10K
SYMBOL res -1184 1344 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10K
SYMBOL diode -1136 1120 R0
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode -1136 1280 R0
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL Opamps\\LT1001 -1456 1152 R0
SYMATTR InstName U9
SYMBOL Opamps\\LT1001 -720 1440 R0
SYMATTR InstName U10
SYMBOL res -656 1520 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value 1K
SYMBOL res -656 1648 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R15
SYMATTR Value 1K
SYMBOL res -512 1440 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R16
SYMATTR Value 2K
SYMBOL Opamps\\UniversalOpamp2 -448 1520 R0
SYMATTR InstName U7
SYMBOL diode -1424 768 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL diode -1424 944 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value 1N4148
TEXT 512 752 Left 2 !.tran 110ms startup
TEXT 352 792 Left 2 ;PWM Pulse: PULSE(0V 5V 10ms 1ms 1ms 0.5s 1s)
TEXT -992 592 Left 2 ;Use FPGA
RECTANGLE Normal 64 1776 -1824 624 2
