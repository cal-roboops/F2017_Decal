Version 4
SHEET 1 2712 2204
WIRE 272 -1712 272 -1760
WIRE 848 -1648 848 -1680
WIRE 272 -1584 272 -1632
WIRE 368 -1584 272 -1584
WIRE 848 -1536 848 -1568
WIRE 944 -1536 848 -1536
WIRE 272 -1520 272 -1584
WIRE -32 -1472 -96 -1472
WIRE 128 -1472 48 -1472
WIRE 208 -1472 128 -1472
WIRE 128 -1440 128 -1472
WIRE 848 -1440 848 -1536
WIRE 784 -1392 704 -1392
WIRE 128 -1344 128 -1360
WIRE 272 -1344 272 -1424
WIRE 272 -1344 128 -1344
WIRE 272 -1312 272 -1344
WIRE 848 -1296 848 -1344
WIRE 272 -1136 272 -1184
WIRE 848 -1136 848 -1168
WIRE 272 -1008 272 -1056
WIRE 352 -1008 272 -1008
WIRE 848 -1008 848 -1056
WIRE 944 -1008 848 -1008
WIRE 272 -960 272 -1008
WIRE 848 -944 848 -1008
WIRE 208 -912 144 -912
WIRE 784 -896 704 -896
WIRE 848 -784 848 -848
WIRE 272 -752 272 -864
WIRE 240 -560 160 -560
WIRE 432 -560 432 -640
WIRE 432 -560 320 -560
WIRE 528 -560 432 -560
WIRE 688 -560 608 -560
WIRE -1152 -448 -1152 -480
WIRE -992 -448 -992 -480
WIRE 432 -384 432 -432
WIRE -1568 -352 -1568 -384
WIRE -1152 -352 -1152 -384
WIRE -992 -352 -992 -384
WIRE 160 -336 160 -560
WIRE 160 -336 32 -336
WIRE 320 -336 160 -336
WIRE 688 -336 688 -560
WIRE 688 -336 544 -336
WIRE 800 -336 688 -336
WIRE -1568 -224 -1568 -272
WIRE -1152 -224 -1152 -272
WIRE -992 -224 -992 -272
WIRE 160 -224 32 -224
WIRE 320 -224 160 -224
WIRE 688 -224 544 -224
WIRE 800 -224 688 -224
WIRE 160 -96 160 -224
WIRE 224 -96 160 -96
WIRE 432 -96 432 -176
WIRE 432 -96 304 -96
WIRE 544 -96 432 -96
WIRE 688 -96 688 -224
WIRE 688 -96 624 -96
WIRE -64 -32 -64 -64
WIRE 960 -32 960 -64
WIRE 432 -16 432 -96
WIRE -1584 80 -1584 32
WIRE -2272 96 -2272 32
WIRE -64 128 -64 48
WIRE -32 128 -64 128
WIRE 960 128 960 48
WIRE 960 128 928 128
WIRE -1584 192 -1584 144
WIRE -64 192 -64 128
WIRE -64 192 -128 192
WIRE 0 192 -64 192
WIRE 960 192 960 128
WIRE 960 192 896 192
WIRE 1024 192 960 192
WIRE -2272 208 -2272 160
WIRE -192 240 -272 240
WIRE 112 240 64 240
WIRE 832 240 784 240
WIRE 1168 240 1088 240
WIRE -64 288 -128 288
WIRE 0 288 -64 288
WIRE 960 288 896 288
WIRE 1024 288 960 288
WIRE -1584 336 -1584 272
WIRE -2272 352 -2272 288
WIRE -64 352 -64 288
WIRE 960 352 960 288
WIRE 432 400 432 368
WIRE 432 528 432 480
WIRE 480 528 432 528
WIRE 432 576 432 528
WIRE 176 624 96 624
WIRE 304 624 256 624
WIRE 368 624 304 624
WIRE 304 704 304 624
WIRE 304 832 304 784
WIRE 432 832 432 672
WIRE 432 832 304 832
WIRE 432 880 432 832
FLAG -1584 336 0
FLAG -1568 -224 0
FLAG -1568 -384 V_Lion
FLAG -1584 32 FPGA_PWM
FLAG 432 880 0
FLAG 96 624 FPGA_PWM
FLAG 960 352 0
FLAG -64 352 0
FLAG -2272 352 0
FLAG 432 -432 V_Lion
FLAG 432 -16 0
FLAG -1152 -224 0
FLAG -1152 -480 V_Gain
FLAG -992 -224 0
FLAG -992 -480 V_SW
FLAG -64 -64 V_Gain
FLAG 960 -64 V_Gain
FLAG 432 -640 0
FLAG -2272 32 Dir
FLAG 272 -1312 0
FLAG 272 -1760 V_SW
FLAG 432 368 V_SW
FLAG -96 -1472 Dir
FLAG 144 -912 FB
FLAG 32 -336 FF
FLAG 1168 240 FB
FLAG -272 240 BB
FLAG 800 -336 BF
FLAG 848 -1680 V_Gain
FLAG 848 -1296 0
FLAG 944 -1536 FF
FLAG 848 -1168 V_Gain
FLAG 848 -784 0
FLAG 944 -1008 BF
FLAG 704 -896 BB
FLAG 704 -1392 FB
FLAG 32 -224 BBM
FLAG -32 128 BBM
FLAG 800 -224 FBM
FLAG 928 128 FBM
FLAG 480 528 iPWM
FLAG 784 240 iPWM
FLAG 112 240 iPWM
FLAG 272 -752 0
FLAG 272 -1184 V_SW
FLAG 368 -1584 FB
FLAG 352 -1008 BB
SYMBOL voltage -1584 176 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VFPGA_FSpeed
SYMATTR Value PULSE(0V 5V 0ms 1us 1us {TP} 1ms)
SYMBOL voltage -1568 -368 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4CLion
SYMATTR Value {VCell*4}
SYMBOL npn 368 576 R0
SYMATTR InstName Q1
SYMATTR Value 2N3904
SYMBOL res 320 688 M0
SYMATTR InstName R1
SYMATTR Value 10K
SYMBOL res 416 384 R0
SYMATTR InstName R2
SYMATTR Value 1K
SYMBOL npn 1088 192 M0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL res 976 -48 M0
SYMATTR InstName R6
SYMATTR Value 10K
SYMBOL npn 832 192 R0
SYMATTR InstName Q4
SYMATTR Value 2N3904
SYMBOL npn -192 192 R0
SYMATTR InstName Q5
SYMATTR Value 2N3904
SYMBOL res -80 -48 R0
SYMATTR InstName R13
SYMATTR Value 10K
SYMBOL npn 64 192 M0
SYMATTR InstName Q6
SYMATTR Value 2N3904
SYMBOL voltage -2272 192 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VFPGA_CTRL
SYMATTR Value PWL(0s 5V 0.25s 5V 0.25001s 0V 0.5s 0V)
SYMBOL NMOSFullBridge 432 -272 R0
SYMATTR InstName X9
SYMBOL voltage -1152 -368 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vg
SYMATTR Value 26V
SYMBOL voltage -992 -368 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VSW
SYMATTR Value 5V
SYMBOL res 208 -80 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 10K
SYMBOL res 640 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10K
SYMBOL res 624 -576 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1Meg
SYMBOL res 224 -544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R20
SYMATTR Value 1Meg
SYMBOL npn 208 -1520 R0
SYMATTR InstName Q11
SYMATTR Value 2N3904
SYMBOL npn 784 -1440 R0
SYMATTR InstName Q7
SYMATTR Value 2N3904
SYMBOL res 832 -1664 R0
SYMATTR InstName R5
SYMATTR Value 10K
SYMBOL npn 784 -944 R0
SYMATTR InstName Q8
SYMATTR Value 2N3904
SYMBOL res 832 -1152 R0
SYMATTR InstName R8
SYMATTR Value 10K
SYMBOL res 256 -1728 R0
SYMATTR InstName R7
SYMATTR Value 1K
SYMBOL res 112 -1456 R0
SYMATTR InstName R4
SYMATTR Value 10K
SYMBOL res -48 -1456 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 10K
SYMBOL res 160 608 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 10K
SYMBOL diode -1168 -384 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMATTR Value 1N4148
SYMBOL diode -1008 -384 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D8
SYMATTR Value 1N4148
SYMBOL diode -1600 144 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D9
SYMATTR Value 1N4148
SYMBOL diode -2288 160 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D10
SYMATTR Value 1N4148
SYMBOL npn 208 -960 R0
SYMATTR InstName Q2
SYMATTR Value 2N3904
SYMBOL res 256 -1152 R0
SYMATTR InstName R10
SYMATTR Value 1K
TEXT -1328 1096 Left 2 !.tran 0 0.5s 0.01s uic
TEXT -1560 320 Left 2 ;PWM Pulse: PULSE(0V 5V 10ms 1ms 1ms 0.5s 1s)
TEXT -1640 -184 Left 2 !.param VCell=4.2
TEXT -1432 968 Left 2 !;.step param TP 0 0.001 0.0001
TEXT -1320 928 Left 2 !.PARAM TP=0.1ms
TEXT -2560 448 Left 2 ;Requires 5V. If 3.3V support needed, put another inverter stage to step-up using 5V switch rail.
TEXT -2432 416 Left 2 ;Need to shutdown PWM for at least 10ms prior to flipping direction
TEXT 1000 8 Left 2 ;10K-20K
TEXT 16 8 Left 2 ;10K-20K
TEXT -1032 -168 Left 2 ;5V or 12V
